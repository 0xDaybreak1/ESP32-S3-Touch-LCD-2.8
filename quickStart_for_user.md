

## 🎯 使用全流程

### 场景一：首次使用（AP 配网模式）

#### Step 1: 连接到 AP 热点

1. 开发板上电后，自动进入 AP 配网模式
2. 手机/电脑搜索 WiFi，找到 `ESP32-ImageDisplay`
3. 输入密码：`12345678`
4. 连接成功

#### Step 2: 打开 Web 控制台

1. 打开浏览器
2. 访问：`http://192.168.4.1`
3. 看到 "ESP32 图片显示控制台" 页面

#### Step 3: 配置 WiFi

1. 点击页面底部的 `⚙️ WiFi 配网` 按钮
2. 输入你的家庭 WiFi 名称和密码（不要使用5G网络）
3. 点击 `💾 保存并重启`
4. 等待设备重启（约 5 秒）

#### Step 4: 连接到家庭 WiFi

1. 手机/电脑切换回家庭 WiFi
2. 访问：`http://vision.local`
3. 或查看页面顶部显示的局域网 IP，直接访问（如 `http://192.168.1.105`）

---

### 场景二：已配网（STA 模式）

#### Step 1: 查看 IP 地址

**方式一：通过 mDNS 域名**

直接访问：`http://vision.local`

**方式二：通过串口日志**

查看串口输出的 IP 地址：

```
✓ WiFi 连接成功 (STA 模式)
  IP 地址: 192.168.1.105
```

**方式三：通过路由器管理界面**

登录路由器，查看 DHCP 客户端列表，找到 `ESP32-S3` 设备

**方式四：通过 Web 页面显示**

访问成功后，页面顶部会显示：

```
🌍 局域网 IP: 192.168.1.105
```

---

### Step 2: 上传图片

#### 方式一：拖拽上传

1. 打开 Web 控制台
2. 将图片文件拖拽到 "📤 上传图片" 区域
3. 等待上传完成（自动显示进度条）
4. 图片自动显示在屏幕上

#### 方式二：点击选择

1. 点击 "📤 上传图片" 区域
2. 选择图片文件（支持任意格式）
3. 等待上传完成
4. 图片自动显示在屏幕上

> 💡 **黑科技**：无论你上传什么格式（PNG/BMP/4K JPEG），浏览器会自动转换为 240x320 的标准 JPEG！

---

### Step 3: 管理图片

#### 查看图片列表

1. 滚动到 "🖼️ 图片库" 区域
2. 点击 `🔄 刷新列表` 按钮
3. 查看所有已上传的图片

#### 显示指定图片

1. 找到想要显示的图片
2. 点击 `📺 显示` 按钮
3. 图片立即显示在屏幕上

#### 删除图片

1. 找到想要删除的图片
2. 点击 `🗑️ 删除` 按钮
3. 确认删除
4. 图片从 SD 卡中移除

---

### Step 4: 设置播放列表

#### 全局轮播（默认）

系统会自动循环播放 SD 卡 `/uploaded` 目录下的所有图片。

#### 自定义播放列表

1. 在 "🖼️ 图片库" 区域勾选想要播放的图片
2. 点击 `▶️ 播放选中图片` 按钮
3. 系统开始循环播放选中的图片

#### 停止播放列表

1. 点击 `⏹️ 停止播放列表` 按钮
2. 恢复全局轮播模式

---

### Step 5: RGB 灯珠控制（预留功能）

1. 滚动到 "🎨 RGB 灯珠控制" 区域
2. 选择颜色和亮度
3. 点击对应的模式按钮：
   - `💡 常亮`：固定颜色常亮
   - `🌊 流水灯`：流水灯效果
   - `💨 呼吸灯`：呼吸灯效果
   - `⚫ 关闭`：关闭灯珠

> ⚠️ **注意**：此功能需要硬件支持，当前为预留接口。

---

## ❓ 常见问题 FAQ

### Q1: 无法访问 `http://vision.local`

**原因**：

- mDNS 服务未启动
- 浏览器不支持 mDNS
- 设备和电脑不在同一网络

**解决方案**：

1. **检查串口日志**，确认 mDNS 启动成功：
   ```
   ✓ mDNS 服务已启动
     访问地址: http://vision.local
   ```

2. **使用 IP 地址访问**：
   - 查看串口日志中的 IP 地址
   - 或查看 Web 页面顶部显示的 IP
   - 直接访问：`http://192.168.1.105`

3. **更换浏览器**：
   - Chrome/Edge：支持良好
   - Firefox：需要手动启用 mDNS
   - Safari：支持良好

4. **检查网络**：
   - 确保设备和电脑在同一 WiFi 网络
   - 关闭 VPN 或代理

### Q2: 无法上传图片

**原因**：

- SD 卡未插入
- SD 卡格式不正确
- SD 卡损坏

**解决方案**：

1. **检查 SD 卡**：
   - 确认 SD 卡已插入
   - 重新插拔 SD 卡
   - 尝试更换 SD 卡

2. **格式化 SD 卡**：
   - 使用 FAT32 格式
   - 分配单元大小：4096 字节
   - Windows：右键 SD 卡 → 格式化
   - Mac：磁盘工具 → 抹掉 → MS-DOS (FAT)

3. **检查串口日志**：
   ```
   ✓ SD 卡初始化成功
   ✓ 创建上传目录: /uploaded
   ```

4. **检查接线**：
   - 参考 [硬件连接](#-硬件连接) 章节
   - 确认 SD_MMC 引脚连接正确

---

### Q3: 图片显示不完整或变形

**原因**：

- 图片尺寸不匹配
- 前端预处理失败

**解决方案**：

1. **检查浏览器控制台**：
   - 按 F12 打开开发者工具
   - 查看 Console 标签
   - 确认预处理日志：
     ```
     图片预处理完成: photo.png -> photo.jpg
     原始大小: 850.23 KB
     处理后大小: 28.45 KB
     ```

2. **重新上传**：
   - 删除有问题的图片
   - 重新上传

3. **更换浏览器**：
   - 推荐使用 Chrome 或 Edge
   - 确保浏览器版本较新


-


### Q4: 如何查看系统状态

**方式一：Web 页面**

访问 Web 控制台，页面顶部显示：

```
🌍 局域网 IP: 192.168.1.105
```


**方式二：串口日志**

查看串口输出的实时日志。



## 🎓 进阶技巧

### 技巧 1：批量上传图片

1. 选择多个图片文件（Ctrl + 点击）
2. 拖拽到上传区域
3. 浏览器会自动逐个处理并上传

### 技巧 2：使用快捷键

- `Ctrl + R`：刷新图片列表
- `F5`：刷新页面
- `F12`：打开开发者工具（查看日志）

### 技巧 3：自定义轮播间隔

修改 `src/main.cpp` 中的轮播间隔：

```cpp
#define IMAGE_DISPLAY_INTERVAL 5000  // 5 秒
```
